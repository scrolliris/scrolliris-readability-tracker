!function e(t,n,r){function i(a,u){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!u&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){var n=t[a][1][e];return i(n?n:e)},s,s.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=e("./index"),o=r(i),a={Client:o.default};"undefined"!=typeof t&&t.exports&&(t.exports=a),window.ScrollirisReadabilityTracker=a},{"./index":9}],2:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,e),null===n&&(n=(new Date).toISOString());var i=new Date,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return new Date(n)}catch(e){return t===!0&&console.warn("[WARNING] baseDate might be wrong.","It must be ISO-8601 format with Timezone."),new Date}};this._value=o(n,!0);var a=function(){var e=new Date-i,r=o(n);r.setMilliseconds(r.getMilliseconds()+e),t._value=r};setInterval(a,10),a()}return i(e,[{key:"getTime",value:function(){return this._value.getTime()}},{key:"value",get:function(){return this._value}}]),e}();n.default=o},{}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this.clear()}return i(e,[{key:"increment",value:function(){return this._value+=1,null}},{key:"clear",value:function(){return this._value=0,null}},{key:"value",get:function(){return this._value}}]),e}();n.default=o},{}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this._protected=null}return i(e,[{key:"_hasDoNotTrack",value:function(){var e="yes"===navigator.doNotTrack||"1"===navigator.doNotTrack||"yes"===window.doNotTrack||"1"===window.doNotTrack||"yes"===navigator.msDoNotTrack||"1"===navigator.msDoNotTrack;return e===!0?"yes":"no"}},{key:"check",value:function(){if("yes"===this._hasDoNotTrack()&&this._protected!==!0){var e="[INFO] ";null===this._protected&&(e+="You have"),this._protected===!1&&(e+="You have enabled"),console.log(e+" `Do Not Track` option.","We respect your privacy and don't track you ;)"),this._protected=!0}else"no"===this._hasDoNotTrack()&&(this._protected===!0&&console.log("[INFO] You have disabled `Do Not Track` option.","The reading data tracking will be started.","Don't worry! even so, we respect always your privacy.","We don't track who you are. ;)"),this._protected=!1);return this._protected}},{key:"protected",get:function(){return this._protected===!0}}]),e}();n.default=o},{}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./scrollbar"),l=r(u),c=e("./screen"),s=r(c),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e),this.clear();var n=document.body,r=document.documentElement;this._selectors=this._configureSelectors(t),this._bar=new l.default,this._view={margin:18,width:Math.max(window.innerWidth-this._bar.width,r.clientWidth),height:Math.max(window.innerHeight-this._bar.height,r.clientHeight)},this._page={},this._page.width=Math.max(r.clientWidth,r.scrollWidth,r.offsetWidth,n.scrollWidth,n.offsetWidth),this._page.height=Math.max(r.clientHeight,r.scrollHeight,r.offsetHeight,n.scrollHeight,n.offsetHeight)}return a(e,[{key:"_configureSelectors",value:function(e){return"undefined"==typeof e||null===e||0===Object.getOwnPropertyNames(e).length?{body:"div.body",heading:"h1,h2,h3,h3,h4,h6",paragraph:"p",sentence:"p > span",material:"img,pre,table,quote"}:e}},{key:"_detectIndex",value:function(e,t,n){if(0===e&&this._isInView(n))return t;if(1===e){if(!this._isInView(n))return t+1;if(0===t)return 0}return null}},{key:"_capture",value:function(e,t){for(var n=e.querySelectorAll(this._selectors[t]),r=n.length-1;r>=0;r--){var i=n[r],o=t+"s",a=this._detectIndex(this._data[o].length,r,i);null!==a&&this._data[o].push(a)}}},{key:"_isInView",value:function(e){var t=e.getBoundingClientRect();return t.top<=this._view.height-this._view.margin&&t.top+t.height>=0&&t.left<=this._view.width-this._view.margin&&t.left+t.width>=0}},{key:"_clone",value:function(){var e={},t={};for(var n in this._data)this._data.hasOwnProperty(n)&&(e[n]=this._data[n]);for(var r in this._info)this._info.hasOwnProperty(r)&&(t[r]=this._info[r]);return[e,t]}},{key:"capture",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._data.count=n.count,this._data.duration=n.duration,this._data.startedAt=n.startedAt,null!==this._data.count&&this._data.count>1)return null;var r=void 0;if(r="undefined"==typeof this._selectors.body||null===this._selectors.body?e:e.querySelector(this._selectors.body),null===r)return null;["heading","paragraph","sentence","material"].map(function(e){t._capture(r,e);var n=e+"s",i=t._data[n].length;1===i?t._data[n][1]=t._data[n][0]:2===i&&t._data[n].sort(function(e,t){return e-t})}),this._info.fullscreen=s.default.isFullscreenMode(),this._info.orientation=s.default.getOrientation(this._view);var i=this._bar.calculate(this._page.width,this._page.height,this._view.width,this._view.height),a=o(i,2),u=a[0],l=a[1];return this._info.scroll={position:u,proportion:l},null}},{key:"dump",value:function(){var e=this._clone(),t=o(e,2),n=t[0],r=t[1];return this.clear(),{data:n,info:r,view:[this._view.width,this._view.height],page:[this._page.width,this._page.height]}}},{key:"clear",value:function(){this._data={headings:[],paragraphs:[],sentences:[],materials:[],count:0,duration:null,startedAt:null},this._info={scroll:{},orientation:{},fullscreen:!1}}}]),e}();n.default=f},{"./screen":6,"./scrollbar":7}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"isFullscreenMode",value:function(){var e=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||!1,t=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null;return e&&null!==t||window.outerWidth===window.screen.availWidth&&window.outerHeight===window.screen.availHeight}},{key:"getOrientation",value:function(e){var t=window.screen.orientation||{angle:0},n=null;return n="undefined"==typeof t||null===t?e.width>e.height?"landscape":"portrait":t.type.replace(/-(primary|secondary)$/,""),{type:n,angle:t?Number.parseInt(t.angle,10):0}}}]),e}();n.default=o},{}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e);var t=this._detectSize(),n=i(t,2);this._width=n[0],this._height=n[1],this._position=[0,0],this._proportion=[0,0]}return o(e,[{key:"_detectSize",value:function(){var e=document.createElement("p");e.style.width="100%",e.style.height="100%";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width="100px",t.style.height="100px",t.style.visibility="hidden",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth,r=e.offsetHeight;t.style.overflow="scroll";var i=e.offsetWidth,o=e.offsetHeight;return n===i&&(i=t.clientWidth),r===o&&(o=t.clientHeight),document.body.removeChild(t),[n-i,r-o]}},{key:"calculate",value:function(e,t,n,r){var i=this.calculatePosition(),o=[].concat(Array.prototype.slice.call(arguments));o.push(i);var a=this.calculatePropotion.apply(this,o);return[i,a]}},{key:"calculatePosition",value:function(){var e=window.pageXOffset||document.documentElement.scrollLeft,t=window.pageYOffset||document.documentElement.scrollTop;return[e,t]}},{key:"calculatePropotion",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:calculatePosition(),o=e-n,a=t-r,u=0===o?0:100*Math.abs(i[0]/o),l=0===a?0:100*Math.abs(i[1]/a);return[u>=100?100:u,l>=100?100:l]}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),e}();n.default=a},{}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r(this,e),this._state="initialized",this._value=t,this._startedAt=null}return i(e,[{key:"start",value:function(){var e=this;return this.pause(),this._interval=setInterval(function(){e._value+=.1},100),this._state="active",this._startedAt=Date.now(),null}},{key:"pause",value:function(){return clearInterval(this.interval),this._state="inactive",null}},{key:"clear",value:function(){return this._value=0,this._state="initialized",this._startedAt=null,null}},{key:"state",get:function(){return this._state}},{key:"value",get:function(){return Number.parseFloat(this._value).toFixed(2)}},{key:"startedAt",get:function(){return this._startedAt}}]),e}();n.default=o},{}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./components/clock"),u=r(a),l=e("./components/counter"),c=r(l),s=e("./components/timer"),f=r(s),d=e("./components/recorder"),h=r(d),v=e("./components/privacy"),p=r(v),y=e("./utils/base64"),g=r(y),w=e("./utils/cookie"),m=r(w),_=e("./utils/uuid"),b=r(_),k=e("./utils/request-worker"),x=r(k),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.publicationKey=t.publicationKey,this.token=t.token,this.clock=n.baseDate?new u.default(n.baseDate):new u.default,this.error=this._checkConfig();var r=n.debug||!1;if(r!==!1&&console.log("[DEBUG] debug mode is enabled"),this.debug=r,this.error)throw new Error("[ERROR]");this.timer=new f.default,this.timer.start(),this.scrolling=!1,this.detecting=!1,this.capturing=!1,this.endpointURL=n.endpointURL||"http://127.0.0.1/",this.traceKey=this._genTraceKey(n.cookieKey||"t"),this.credentials={token:this.token,publicationKey:this.publicationKey},this.privacy=new p.default,this.counter=new c.default,this.worker=window.Worker?new window.Worker(window.URL.createObjectURL(x.default)):null,this.domain=window.location.host.replace(/:[0-9]*$/g,"")}return o(e,[{key:"_checkConfig",value:function(){var e=!1;return"undefined"!=typeof this.publicationKey&&null!==this.publicationKey&&""!==this.publicationKey||(e=!0,console.error("[ERROR] publicationKey is needed")),"undefined"!=typeof this.token&&null!==this.token&&""!==this.token||(e=!0,console.error("[ERROR] (CSRF) token is needed")),e}},{key:"_genTraceKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"t",t=m.default.read(e);return"undefined"!=typeof t&&null!==t||(t=g.default.urlsafe_b64encode(b.default.uuid4()).replace(/\=\=$/,""),m.default.write(e,t,45)),t+="--"}},{key:"_sendAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll";if(this.error||this.privacy.check()&&this.privacy.protected===!0)return null;if("undefined"==typeof this.recorder)return null;var t=this.recorder.dump()||{data:null,info:null},n=t.data,r=t.info;if(null===n||null===n.duration||null===r||0===Object.getOwnPropertyNames(r.scroll).length)return this.counter.clear(),null;var i={domain:this.domain,path:window.location.pathname,traceKey:this.traceKey,record:t,eventType:e,count:this.counter.value,duration:this.timer.value,startedAt:this.timer.startedAt,timestamp:this.clock.getTime(),extra:this.extra};return this.debug===!0?(console.log(i),null):void(null!==this.worker&&this.worker.postMessage([i,this.endpointURL,this.credentials]))}},{key:"_track",value:function(e){var t=this;return this.error||this.privacy.check()&&this.privacy.protected===!0?null:(this.recorder||"undefined"==typeof e||(this.recorder=new h.default(e)),void(this.detecting=setTimeout(function(){var e=new c.default,n=new f.default,r=t.clock.getTime();n.start(),t.counter.increment(),t.capturing=setInterval(function(){e.increment(),t.recorder.capture(t.article,{count:e.value,duration:n.value,startedAt:r})},500)},250)))}},{key:"record",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.article=e,this.extra=t.extra||{};var n=t.selectors||null;return"undefined"==typeof this.article||null===this.article?(console.error("[ERROR] valid article DOM is needed"),null):void this._track(n)}},{key:"ready",value:function(e,t){var n=this;if("undefined"==typeof document.addEventListener||"undefined"==typeof document.hidden)return console.error("[ERROR] This page requires a browser, such as Firefox that supports the modern APIs."),this.error=!0,null;var r=function(){"active"===n.timer.state?n.timer.pause():n.timer.start()};document.addEventListener("visibilitychange",function(e){if(n.error||n.privacy.check()&&n.privacy.protected===!0)return!1;if(e){e.preventDefault(),r();var t=e.type.match(/visibilitychange$/i);(t&&document.hidden||!t)&&n._sendAction(e.type)}else r()},null),document.addEventListener("fullscreenchange",function(e){if(n.error||n.privacy.check()&&n.privacy.protected===!0)return!1;if(e){e.preventDefault(),r();var t=e.type.match(/fullscreenchange$/i);t&&n._sendAction(e.type)}else r()},null);var i=setInterval(function(){e.every(function(e){return document.querySelector(e)})&&o()},200),o=function(){clearInterval(i),n.article||t()};document.addEventListener("DOMContentLoaded",o);var a=function(){clearTimeout(n.detecting),clearInterval(n.capturing),"undefined"==typeof n.scrolling||null===n.scrolling||n.scrolling===!1?n._sendAction("scroll"):clearTimeout(n.scrolling),n.scrolling=setTimeout(function(){n.scrolling=null},200),n.article||t(),n._track()};document.addEventListener("scroll",a)}}]),e}();n.default=O},{"./components/clock":2,"./components/counter":3,"./components/privacy":4,"./components/recorder":5,"./components/timer":8,"./utils/base64":10,"./utils/cookie":11,"./utils/request-worker":12,"./utils/uuid":13}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"urlsafe_b64encode",value:function(e){for(var t=e.replace(/[\-{}]/g,""),n="",r=0;r<t.length;r+=2)n+=String.fromCharCode(Number.parseInt(t.charAt(r)+t.charAt(r+1),16));return window.btoa(n).replace(/\+/g,"-").replace(/\//g,"_")}}]),e}();n.default=o},{}],11:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"write",value:function(e,t,n){var r="",i=new Date;return i.setTime(i.getTime()+60*n*1e3),r="expires="+i.toUTCString(),document.cookie=e+"="+t+"; "+r+"; path=/",t}},{key:"read",value:function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;++n){for(var r=t[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e+"="))return r.substring(e.length+1,r.length)}}},{key:"delete",value:function(t){e.write(t,"",-4320)}}]),e}();n.default=o},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){var t=e.data[0]||{},n=e.data[1]||"http://127.0.0.1",r=e.data[2]||{token:"",publicationKey:""},i=!1,o=new XMLHttpRequest;o.open("PUT",n,i),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-CSRF-Token",r.token),o.setRequestHeader("X-Publication-Key",r.publicationKey),o.send(JSON.stringify(t))},i="onmessage = "+String(r),o=void 0;try{o=new Blob([i],{type:"text/javascript"})}catch(e){if("undefined"!=typeof window){if("undefined"==typeof BlobBuilder)throw e;o=new BlobBuilder,o.append(i),o=o.getBlob()}}n.default=o},{}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"uuid4",value:function(){var e=Date.now();window.performance&&"function"==typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t}}]),e}();n.default=o},{}]},{},[1]);